<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kiosk</title>
  <style>
    html, body { margin:0; height:100%; background:#000; overflow:hidden; }
    .screen { position:fixed; inset:0; display:none; }
    .screen.active { display:block; }

    /* YouTubeå¾…æ©Ÿå‹•ç”» */
    #idleVideoWrap { width:100%; height:100%; }
    #idleVideo { width:100%; height:100%; border:0; background:#000; pointer-events:none; }

    /* Googleã‚¹ãƒ©ã‚¤ãƒ‰ */
    iframe { width:100%; height:100%; border:0; background:#000; }
 
    /* â†â†â† ã“ã“ã«è¿½åŠ ã™ã‚Œã°OKï¼ */
  #backToVideo{
    position: fixed;
    top: 16px;
    right: 16px;
    z-index: 9999;
    padding: 10px 14px;
    font-size: 16px;
    border: 0;
    border-radius: 999px;
    background: rgba(0,0,0,.65);
    color: #fff;
    display: none; /* 1æšç›®ã ã‘è¡¨ç¤ºã™ã‚‹ã®ã§æœ€åˆã¯éè¡¨ç¤º */
    cursor: pointer;
  }
    
    .hint {
      position:fixed; left:0; right:0; bottom:24px;
      text-align:center; color:rgba(255,255,255,.85);
      font: 20px/1.3 system-ui, -apple-system, "Segoe UI", sans-serif;
      pointer-events:none;
      text-shadow:0 2px 8px rgba(0,0,0,.6);
    }
  </style>
</head>
<body>

  <!-- å¾…æ©Ÿï¼šYouTubeå‹•ç”»ãƒ«ãƒ¼ãƒ— -->
  <div id="idle" class="screen active">
    <div id="idleVideoWrap">
      <iframe
        id="idleVideo"
        src=""
        title="Idle video"
        frameborder="0"
        allow="autoplay; encrypted-media; picture-in-picture"
        allowfullscreen
      ></iframe>
    </div>
    <div class="hint">ç”»é¢ã‚’ã‚¿ãƒƒãƒ—ã—ã¦é–‹å§‹</div>
  </div>

  <!-- æ¢ç´¢ï¼šGoogleã‚¹ãƒ©ã‚¤ãƒ‰ï¼ˆã‚¹ãƒ©ã‚¤ãƒ‰1ã‹ã‚‰ï¼‰ -->
<div id="explore" class="screen">
  <button id="backToVideo" type="button">ğŸ¥ å‹•ç”»ã¸æˆ»ã‚‹</button>
  <iframe id="slides" allowfullscreen></iframe>
</div>


  <script>
    // â˜…Googleã‚¹ãƒ©ã‚¤ãƒ‰IDï¼ˆd/XXXXX ã® XXXXXï¼‰
    const SLIDE_ID = "1XTp8s8WNJa6qFl9K2akNzSv43JRHN-pQ";

    // â˜…YouTubeå‹•ç”»IDï¼ˆURLã® v=XXXX ã® XXXXï¼‰ã‚’å…¥ã‚Œã¦ãã ã•ã„
    const YOUTUBE_ID = "nKfVdy0jiLo";

    // æ”¾ç½®ã§æˆ»ã‚‹ã¾ã§ã®æ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰ 60ç§’ = 60000
    const IDLE_TIMEOUT_MS = 60000;

    const idleScreen = document.getElementById("idle");
    const exploreScreen = document.getElementById("explore");
    const slidesFrame = document.getElementById("slides");
    const idleVideoFrame = document.getElementById("idleVideo");

    let timer = null;

    function slideEmbedUrl() {
      // start=falseï¼šè‡ªå‹•é–‹å§‹ã—ãªã„ï¼ˆã‚¿ãƒƒãƒ—ã§ãƒªãƒ³ã‚¯æ¢ç´¢ã—ãŸã„å ´åˆï¼‰
      return `https://docs.google.com/presentation/d/${SLIDE_ID}/embed?rm=minimal&start=false`;
    }

    function idleYoutubeUrl() {
      // autoplay=1ï¼šè‡ªå‹•å†ç”Ÿï¼ˆâ€»mute=1ãŒå¿…é ˆï¼‰
      // loop=1 ã¨ playlist=IDï¼šç„¡é™ãƒ«ãƒ¼ãƒ—
      // controls=0ï¼šUIéè¡¨ç¤ºï¼ˆèª¤æ“ä½œé˜²æ­¢ï¼‰
      // playsinline=1ï¼šãƒ¢ãƒã‚¤ãƒ«ã§å…¨ç”»é¢åŒ–ã—ã«ããã™ã‚‹
      return `https://www.youtube.com/embed/${YOUTUBE_ID}?autoplay=1&mute=1&loop=1&playlist=${YOUTUBE_ID}&controls=0&modestbranding=1&playsinline=1&rel=0`;
    }

    function showIdle() {
      exploreScreen.classList.remove("active");
      idleScreen.classList.add("active");

      // ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’æ­¢ã‚ã‚‹
      slidesFrame.src = "about:blank";

      // YouTubeå¾…æ©Ÿå‹•ç”»ã‚’ã€Œå†èª­ã¿è¾¼ã¿ã€ã—ã¦ç¢ºå®Ÿã«å†é–‹
      idleVideoFrame.src = idleYoutubeUrl();

      clearTimeout(timer);
      timer = null;
    }

    function showExplore() {
      idleScreen.classList.remove("active");
      exploreScreen.classList.add("active");

      // æ¢ç´¢ã«å…¥ã£ãŸã‚‰YouTubeã‚’æ­¢ã‚ã‚‹ï¼ˆå†ç”Ÿç¶™ç¶šé˜²æ­¢ï¼‰
      idleVideoFrame.src = "about:blank";

      slidesFrame.src = slideEmbedUrl();
      resetIdleTimer();
    }

    function resetIdleTimer() {
      clearTimeout(timer);
      timer = setTimeout(showIdle, IDLE_TIMEOUT_MS);
    }

    // åˆå›ã‚¿ãƒƒãƒ—ã§æ¢ç´¢é–‹å§‹ï¼ˆå¾…æ©Ÿâ†’ã‚¹ãƒ©ã‚¤ãƒ‰ï¼‰
    document.addEventListener("pointerdown", () => {
      if (idleScreen.classList.contains("active")) {
        showExplore();
      } else {
        // æ¢ç´¢ä¸­ã®æ“ä½œã¯å…¨éƒ¨â€œæ“ä½œã‚ã‚Šâ€æ‰±ã„ã«ã—ã¦ã‚¿ã‚¤ãƒãƒ¼å»¶é•·
        resetIdleTimer();
      }
    });

    // è§¦ã£ã¦ã‚‹é–“ã¯æˆ»ã‚‰ãªã„ã‚ˆã†ã«ã€ã‚ˆãã‚ã‚‹æ“ä½œã‚’å…¨éƒ¨æ‹¾ã†
    ["pointermove","keydown","wheel","touchstart","mousemove"].forEach(ev => {
      document.addEventListener(ev, () => {
        if (exploreScreen.classList.contains("active")) resetIdleTimer();
      }, { passive:true });
    });

    // èµ·å‹•ç›´å¾Œã¯å¾…æ©Ÿï¼ˆYouTubeé–‹å§‹ï¼‰
    showIdle();

    const backBtn = document.getElementById("backToVideo");

backBtn.addEventListener("click", (e) => {
  e.stopPropagation();
  showIdle();
});

// ã‚¹ãƒ©ã‚¤ãƒ‰ã®URLå¤‰åŒ–ã‚’ç›£è¦–
slidesFrame.addEventListener("load", () => {
  checkSlide();
});

// å®šæœŸçš„ã«ãƒã‚§ãƒƒã‚¯ï¼ˆGoogleã‚¹ãƒ©ã‚¤ãƒ‰ã¯hashãŒå¤‰ã‚ã‚‹ï¼‰
setInterval(checkSlide, 500);

function checkSlide(){
  try{
    const url = slidesFrame.contentWindow.location.href;

    // 1æšç›®ã®ã¨ãã ã‘è¡¨ç¤ºï¼ˆid.p ãŒæœ€åˆã®ã‚¹ãƒ©ã‚¤ãƒ‰ï¼‰
    if(url.includes("#slide=id.p")){
      backBtn.style.display = "block";
    }else{
      backBtn.style.display = "none";
    }
  }catch(e){
    // ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ã§èª­ã‚ãªã„å ´åˆã¯éè¡¨ç¤º
    backBtn.style.display = "none";
  }
}

  </script>
</body>
</html>




